"use strict";(self.webpackChunkgive_recieve_service_app_frontend=self.webpackChunkgive_recieve_service_app_frontend||[]).push([[311],{311:(O,m,a)=>{a.r(m),a.d(m,{GiveModule:()=>N});var _=a(665),s=a(583),e=a(639),v=a(779),p=a(855),h=a(841);const d=function(n,r){return{"each-expired":n,"each-accepted":r}},u=function(n,r,t,i,o,c){return{"catagory-marker-yellow":n,"catagory-marker-blue":r,"catagory-marker-red":t,"catagory-marker-green":i,"catagory-marker-purple":o,"catagory-marker-grey":c}};function f(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"div",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).handleClick(o)}),e.TgZ(2,"h3",16),e._uU(3),e.qZA(),e._uU(4," by "),e.TgZ(5,"p",17),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e._UZ(10,"div",14),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.Q6J("ngClass",e.WLB(9,d,t.expired,t.fulfilled)),e.xp6(3),e.Oqu(t.service.title),e.xp6(3),e.AsE("",t.firstname," ",t.lastname,""),e.xp6(2),e.Oqu(e.xi3(9,6,t.createdAt,"medium")),e.xp6(2),e.Q6J("ngClass",e.HTZ(12,u,"food"===t.service.catagory,"hygine"===t.service.catagory,"pets"===t.service.catagory,"entertainment"===t.service.catagory,"religion"===t.service.catagory,"education"===t.service.catagory))}}function y(n,r){if(1&n&&(e.TgZ(0,"div",12),e.YNc(1,f,11,19,"div",13),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.expired)}}function Z(n,r){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,y,2,1,"div",11),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.services)}}function b(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"div",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).handleClick(o)}),e.TgZ(2,"h3",16),e._uU(3),e.qZA(),e._uU(4," by "),e.TgZ(5,"p",17),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e._UZ(10,"div",14),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.Q6J("ngClass",e.WLB(9,d,t.expired,t.fulfilled)),e.xp6(3),e.Oqu(t.service.title),e.xp6(3),e.AsE("",t.firstname," ",t.lastname,""),e.xp6(2),e.Oqu(e.xi3(9,6,t.createdAt,"medium")),e.xp6(2),e.Q6J("ngClass",e.HTZ(12,u,"food"===t.service.catagory,"hygine"===t.service.catagory,"pets"===t.service.catagory,"entertainment"===t.service.catagory,"religion"===t.service.catagory,"education"===t.service.catagory))}}function C(n,r){if(1&n&&(e.TgZ(0,"div",12),e.YNc(1,b,11,19,"div",13),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.expired)}}function T(n,r){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,C,2,1,"div",11),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.searchResult)}}let x=(()=>{class n{constructor(t,i,o){this.provide=t,this.router=i,this.client=o,this.dateNow=new Date,this.city=localStorage.getItem("city")}searching(t){console.log(t.target.value),this.isSearching=!0,this.searchResult=this.services.filter(i=>this.searchResult=i.service.title.toLowerCase().includes(t.target.value.toLowerCase())),console.log(this.searchResult),t.target.value||(this.isSearching=!1)}checkLocation(t){console.log(t.coords.latitude,t.coords.longitude)}displayLocation(t,i){}showMap(t){let i=t[0].location.coords,o=L.map("map").setView([i.latitude,i.longitude],13);L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWludGVzNCIsImEiOiJja3g2Y2htdDcya3ZqMnZwMnZ6ZnJtcXZjIn0.rI21ie3tyJCsjxxxoNLO1g",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"your.mapbox.access.token"}).addTo(o),t.forEach(c=>{let l=c.location.coords;L.marker([l.latitude,l.longitude]).addTo(o).bindPopup(`<b>${c.service.title}</b><br>`).openPopup()})}previousGroup(){this.page>1&&this.provide.getAllProvideServices(this.city,this.page-1).subscribe(t=>{this.services=t.data,this.services.forEach(i=>{this.checkDate(i)}),this.page--})}nextGroup(){this.page>=1&&this.provide.getAllProvideServices(this.city,this.page+1).subscribe(t=>{t.data&&(this.services=t.data,this.services.forEach(i=>{this.checkDate(i)})),this.page++})}handleClick(t){console.log(t),this.router.navigate(["","give","service",t._id])}addService(){this.router.navigate(["","add-service","provide"],{state:{msg:"Add a Service"}})}checkDate(t){let i=new Date,o=new Date(t.createdAt),c=Math.abs(i-o)/1e3;Math.floor(c/86400)>2&&(t.expired=!0,console.log(t.service.title,t._id))}getCity(){let t=localStorage.getItem("latitude"),i=localStorage.getItem("longitude");this.provide.getCity("http://mapquestapi.com/geocoding/v1/reverse?key=HkNMLlrytjUgy3XYLEdlIdKA09yvLFLH&location="+t+","+i).subscribe(g=>{localStorage.setItem("city",JSON.stringify(g.results[0].locations[0].adminArea5))});let l=localStorage.getItem("city");this.city=JSON.parse(l)}fetchLocation(){let t={coords:{latitude:localStorage.getItem("latitude"),longitude:localStorage.getItem("longitude")},timestamp:localStorage.getItem("timestamp")};this.geoLocation=Object.assign({},t)}ngOnInit(){console.log(this.city),this.provide.getAllProvideServices(this.city).subscribe(t=>{console.log(t.data),this.services=t.data,this.page=1,this.services.forEach(i=>{this.checkDate(i)})})}ngDoCheck(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.X),e.Y36(p.F0),e.Y36(h.eN))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-given-services"]],decls:16,vars:2,consts:[[1,"i"],[1,"i-left"],[1,"circle-button","btn","btn-primary",3,"click"],[1,"prevBtn","btn","btn-basic","btn-lg",3,"click"],["class","i-middle",4,"ngIf","ngIfElse"],["search",""],[1,"i-right"],["placeholder","search service",1,"input","form-control","form-control-sm",3,"keyup"],[1,"nextBtn","btn","btn-basic","btn-lg",3,"click"],["id","map"],[1,"i-middle"],["class","each",4,"ngFor","ngForOf"],[1,"each"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[3,"click"],[1,"title"],[1,"sub-title"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return i.addService()}),e._uU(3," +"),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"button",3),e.NdJ("click",function(){return i.previousGroup()}),e._uU(6," << Previous "),e.qZA(),e.qZA(),e.YNc(7,Z,2,1,"div",4),e.YNc(8,T,2,1,"ng-template",null,5,e.W1O),e.TgZ(10,"div",6),e.TgZ(11,"input",7),e.NdJ("keyup",function(c){return i.searching(c)}),e.qZA(),e.TgZ(12,"button",8),e.NdJ("click",function(){return i.nextGroup()}),e._uU(13," Next >> "),e.qZA(),e._UZ(14,"div",9),e.qZA(),e.qZA(),e._UZ(15,"router-outlet")),2&t){const o=e.MAs(9);e.xp6(7),e.Q6J("ngIf",!i.isSearching)("ngIfElse",o)}},directives:[s.O5,p.lC,s.sg,s.mk],pipes:[s.uU],styles:["#map[_ngcontent-%COMP%]{width:100%;height:70%}"]}),n})(),k=(()=>{class n{transform(t){return t.toUpperCase()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"catagory",type:n,pure:!0}),n})();function A(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",15),e.TgZ(1,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().editClicked()}),e._uU(2," Edit "),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"button",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().removeService()}),e._uU(5," Delete "),e.qZA(),e.qZA()}}function S(n,r){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"div",22),e.TgZ(2,"a"),e._uU(3),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.qZA(),e.qZA(),e.qZA()),2&n){const t=r.$implicit;e.xp6(3),e.AsE(" ",t.firstname," ",t.lastname," "),e.xp6(2),e.hij(" ",t.comment," ")}}function q(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e.YNc(1,S,6,3,"div",19),e.TgZ(2,"div"),e.TgZ(3,"input",20),e.NdJ("keyup",function(o){return e.CHM(t),e.oxw().commenting(o)}),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().postComment()}),e._uU(6," Comment "),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.comments)}}function w(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).acceptOffer()}),e._uU(1," Accept "),e.qZA()}}function I(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).acceptOffer()}),e._uU(1," Fulfilled "),e.qZA()}}function U(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,w,2,0,"button",23),e.YNc(2,I,2,0,"button",24),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.service.fulfilled),e.xp6(1),e.Q6J("ngIf",t.service.fulfilled)}}const G=function(n,r,t,i,o,c){return{"catagory-marker-yellow":n,"catagory-marker-blue":r,"catagory-marker-red":t,"catagory-marker-green":i,"catagory-marker-purple":o,"catagory-marker-grey":c}};let J=(()=>{class n{constructor(t,i,o){this.activatedRoute=t,this.provide=i,this.router=o,this.showComments=!1,this.comments=[{firstname:"mintes",lastname:"gebre",comment:"i love it"},{firstname:"robbie",lastname:"benti",comment:"i need this service"}],this.title="Update a Service",this.activatedRoute.paramMap.subscribe(c=>{this.id=c.get("id"),this.provide.getCourseById(c.get("id")).subscribe(l=>{this.service=l.data,this.showMap(this.service),this.service.firstname===this.user.firstname&&this.service.lastname===this.user.lastname&&(this.isCreator=!0)})})}commenting(t){this.newComment=t.target.value}postComment(){let t={firstname:this.user.firstname,lastname:this.user.lastname,comment:this.newComment};this.comments.push(t),this.provide.postComment(this.id,t).subscribe(i=>{console.log(i)})}editClicked(){this.router.navigate(["","update-service","provide"],{state:{data:this.service,msg:this.title}})}showMap(t){let i=t.location.coords,o=L.map("map").setView([i.latitude,i.longitude],13);L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWludGVzNCIsImEiOiJja3g2Y2htdDcya3ZqMnZwMnZ6ZnJtcXZjIn0.rI21ie3tyJCsjxxxoNLO1g",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"your.mapbox.access.token"}).addTo(o),L.marker([i.latitude,i.longitude]).addTo(o).bindPopup(`<b>${t.service.title}</b><br>by <b>${t.firstname}</b>`).openPopup(),L.popup().setLatLng([i.latitude,i.longitude]).setContent(`${t.service.title} by <b>${t.firstname}</b>`).openOn(o)}removeService(){let t=prompt('Are you sure? Type "yes" to confirm');console.log(t),"yes"===t&&this.provide.deleteById(this.id).subscribe(i=>{i.success&&this.router.navigate(["","give"])})}acceptOffer(){this.provide.updateUserAndService(this.user._id,this.service._id,{}).subscribe(t=>{console.log(t)}),this.service.fulfilled=!0,console.log("accepted offer")}ngOnInit(){this.isCreator=!1;let t=localStorage.getItem("payload");this.user=JSON.parse(t)}ngDoCheck(){(this.service.firstname!==this.user.firstname||this.service.lastname!==this.user.lastname)&&(this.isCreator=!1)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.gz),e.Y36(v.X),e.Y36(p.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-given-service"]],decls:29,vars:23,consts:[[1,"i"],[1,"i-left"],["class","checkUser",4,"ngIf"],["id","map"],[1,"i-middle"],[1,"service-detail"],[1,"deco-lone",3,"ngClass"],[1,"title"],[1,"sub-title"],[1,"h3"],[1,"author"],[1,"comments",3,"click"],["class","commentContainer",4,"ngIf"],[1,"i-right"],[4,"ngIf"],[1,"checkUser"],[1,"circle-button","btn","btn-primary",3,"click"],[1,"general-margin","circle-button","btn","btn-primary",3,"click"],[1,"commentContainer"],[4,"ngFor","ngForOf"],["type","text",1,"commentInput",3,"keyup"],[1,"btn","btn-primary",3,"click"],[1,"eachComment"],["class","btn btn-primary circle-button acceptoffer",3,"click",4,"ngIf"],["class","btn btn-primary circle-button fulfilledoffer",3,"click",4,"ngIf"],[1,"btn","btn-primary","circle-button","acceptoffer",3,"click"],[1,"btn","btn-primary","circle-button","fulfilledoffer",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,A,6,0,"div",2),e.TgZ(3,"div",3),e._uU(4,"hi"),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e._uU(8),e.ALo(9,"catagory"),e.qZA(),e.TgZ(10,"h3",7),e._uU(11),e.qZA(),e.TgZ(12,"p",8),e._uU(13),e.qZA(),e._uU(14," $ "),e.TgZ(15,"span",9),e._uU(16),e.qZA(),e._uU(17," per hour by "),e.TgZ(18,"a"),e.TgZ(19,"p",10),e._uU(20),e.qZA(),e.qZA(),e.TgZ(21,"p"),e._uU(22),e.ALo(23,"date"),e.qZA(),e.qZA(),e.TgZ(24,"div",11),e.NdJ("click",function(){return i.showComments=!i.showComments}),e._uU(25," Comments "),e.qZA(),e.YNc(26,q,7,1,"div",12),e.qZA(),e.TgZ(27,"div",13),e.YNc(28,U,3,2,"div",14),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",i.isCreator),e.xp6(5),e.Q6J("ngClass",e.HTZ(16,G,"food"===i.service.service.catagory,"hygine"===i.service.service.catagory,"pets"===i.service.service.catagory,"entertainment"===i.service.service.catagory,"religion"===i.service.service.catagory,"education"===i.service.service.catagory)),e.xp6(1),e.hij(" ",e.lcZ(9,11,i.service.service.catagory)," "),e.xp6(3),e.Oqu(i.service.service.title),e.xp6(2),e.Oqu(i.service.service.detail),e.xp6(3),e.Oqu(i.service.hourlyPayment),e.xp6(4),e.AsE(" ",i.service.firstname," ",i.service.lastname," "),e.xp6(2),e.Oqu(e.xi3(23,13,i.service.createdAt,"medium")),e.xp6(4),e.Q6J("ngIf",i.showComments),e.xp6(2),e.Q6J("ngIf",!i.isCreator))},directives:[s.O5,s.mk,s.sg],pipes:[k,s.uU],styles:["#map[_ngcontent-%COMP%]{width:80%;height:80%}"]}),n})(),N=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[s.ez,_.UX,p.Bz.forChild([{path:"",component:x},{path:"service/:id",component:J}])]]}),n})()}}]);