"use strict";(self.webpackChunkgive_recieve_service_app_frontend=self.webpackChunkgive_recieve_service_app_frontend||[]).push([[857],{857:(J,p,a)=>{a.r(p),a.d(p,{RecieveModule:()=>U});var o=a(583),e=a(639),l=a(855),d=a(779);let v=(()=>{class r{transform(t){return t.toUpperCase()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275pipe=e.Yjl({name:"catagory",type:r,pure:!0}),r})();function g(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",16),e.TgZ(1,"button",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().editClicked()}),e._uU(2," Edit"),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().removeService()}),e._uU(5," Delete "),e.qZA(),e.qZA()}}function f(r,n){if(1&r&&(e.TgZ(0,"div"),e.TgZ(1,"div",23),e.TgZ(2,"a"),e._uU(3),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.qZA(),e.qZA(),e.qZA()),2&r){const t=n.$implicit;e.xp6(3),e.AsE(" ",t.firstname," ",t.lastname," "),e.xp6(2),e.hij(" ",t.comment," ")}}function h(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",19),e.YNc(1,f,6,3,"div",20),e.TgZ(2,"div"),e.TgZ(3,"input",21),e.NdJ("keyup",function(c){return e.CHM(t),e.oxw().commenting(c)}),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"button",22),e.NdJ("click",function(){return e.CHM(t),e.oxw().postComment()}),e._uU(6," Comment "),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.comments)}}function Z(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).acceptOffer()}),e._uU(1," Accept "),e.qZA()}}function y(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).fulfilledOffer()}),e._uU(1," Fulfilled "),e.qZA()}}function b(r,n){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,Z,2,0,"button",24),e.YNc(2,y,2,0,"button",25),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.service.fulfilled),e.xp6(1),e.Q6J("ngIf",t.service.fulfilled)}}const C=function(r,n,t,i,c,s){return{"catagory-marker-yellow":r,"catagory-marker-blue":n,"catagory-marker-red":t,"catagory-marker-green":i,"catagory-marker-purple":c,"catagory-marker-grey":s}};let q=(()=>{class r{constructor(t,i,c){this.ar=t,this.receive=i,this.router=c,this.showComments=!1,this.title="Update a Service",this.ar.paramMap.subscribe(s=>{this.id=s.get("id"),this.receive.getCourseById(s.get("id")).subscribe(u=>{this.service=u.data,this.comments=this.service.comment,this.showMap(this.service),this.service.firstname===this.user.firstname&&this.service.lastname===this.user.lastname&&(this.isCreator=!0)})})}commenting(t){this.newComment=t.target.value}postComment(){let t=localStorage.getItem("payload"),i=JSON.parse(t),c={firstname:i.firstname,lastname:i.lastname,comment:this.newComment};this.comments.push(c),this.receive.postComment(this.id,c).subscribe(s=>{console.log(s)})}editClicked(){this.router.navigate(["","update-service","request"],{state:{data:this.service,msg:this.title}})}showMap(t){let i=t.location.coords,c=L.map("map").setView([i.latitude,i.longitude],13);L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWludGVzNCIsImEiOiJja3g2Y2htdDcya3ZqMnZwMnZ6ZnJtcXZjIn0.rI21ie3tyJCsjxxxoNLO1g",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"your.mapbox.access.token"}).addTo(c),L.marker([i.latitude,i.longitude]).addTo(c).bindPopup(`<b>${t.service.title}</b><br>by <b>${t.firstname}</b>`).openPopup(),L.popup().setLatLng([i.latitude,i.longitude]).setContent(`${t.service.title} by <b>${t.firstname}</b>`).openOn(c)}removeService(){let t=prompt('Are you sure? Type "yes" to confirm');console.log(t),"yes"===t&&this.receive.deleteById(this.id).subscribe(i=>{i.success&&this.router.navigate(["","recieve"])})}acceptOffer(){this.receive.updateUserAndService(this.user._id,this.service._id,{}).subscribe(t=>{console.log(t)}),this.service.fulfilled=!0,console.log("accepted offer")}fulfilledOffer(){console.log("fulfilled offer")}ngOnInit(){this.isCreator=!1;let t=localStorage.getItem("payload");this.user=JSON.parse(t)}ngDoCheck(){(this.service.firstname!==this.user.firstname||this.service.lastname!==this.user.lastname)&&(this.isCreator=!1)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(l.gz),e.Y36(d.X),e.Y36(l.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-requested-service"]],decls:29,vars:23,consts:[[1,"i"],[1,"i-left"],["class","checkUser",4,"ngIf"],["id","map"],[1,"i-middle"],[1,"service-detail"],[1,"deco-lone",3,"ngClass"],[1,"title"],[1,"sub-title"],[1,"h3"],[3,"routerLink"],[1,"author"],[1,"comments",3,"click"],["class","commentContainer",4,"ngIf"],[1,"i-right"],[4,"ngIf"],[1,"checkUser"],[1,"circle-button","btn","btn-primary",3,"click"],[1,"general-margin","circle-button","btn","btn-primary",3,"click"],[1,"commentContainer"],[4,"ngFor","ngForOf"],["type","text",1,"commentInput",3,"keyup"],[1,"btn","btn-primary",3,"click"],[1,"eachComment"],["class","btn btn-primary circle-button acceptoffer",3,"click",4,"ngIf"],["class","btn btn-primary circle-button fulfilledoffer",3,"click",4,"ngIf"],[1,"btn","btn-primary","circle-button","acceptoffer",3,"click"],[1,"btn","btn-primary","circle-button","fulfilledoffer",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,g,6,0,"div",2),e.TgZ(3,"div",3),e._uU(4,"hi"),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e._uU(8),e.ALo(9,"catagory"),e.qZA(),e.TgZ(10,"h3",7),e._uU(11),e.qZA(),e.TgZ(12,"p",8),e._uU(13),e.qZA(),e._uU(14," $ "),e.TgZ(15,"span",9),e._uU(16),e.qZA(),e._uU(17," per hour by "),e.TgZ(18,"a",10),e.TgZ(19,"p",11),e._uU(20),e.qZA(),e.qZA(),e.TgZ(21,"p"),e._uU(22),e.ALo(23,"date"),e.qZA(),e.qZA(),e.TgZ(24,"div",12),e.NdJ("click",function(){return i.showComments=!i.showComments}),e._uU(25," Comments "),e.qZA(),e.YNc(26,h,7,1,"div",13),e.qZA(),e.TgZ(27,"div",14),e.YNc(28,b,3,2,"div",15),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",i.isCreator),e.xp6(5),e.Q6J("ngClass",e.HTZ(16,C,"food"===i.service.service.catagory,"hygine"===i.service.service.catagory,"pets"===i.service.service.catagory,"entertainment"===i.service.service.catagory,"religion"===i.service.service.catagory,"education"===i.service.service.catagory)),e.xp6(1),e.hij(" ",e.lcZ(9,11,i.service.service.catagory)," "),e.xp6(3),e.Oqu(i.service.service.title),e.xp6(2),e.Oqu(i.service.service.detail),e.xp6(3),e.Oqu(i.service.hourlyPayment),e.xp6(4),e.AsE(" ",i.service.firstname," ",i.service.lastname," "),e.xp6(2),e.Oqu(e.xi3(23,13,i.service.createdAt,"medium")),e.xp6(4),e.Q6J("ngIf",i.showComments),e.xp6(2),e.Q6J("ngIf",!i.isCreator))},directives:[o.O5,o.mk,l.yS,o.sg],pipes:[v,o.uU],styles:[".service-detail[_ngcontent-%COMP%]{backgroundColor:#EEEBDD}#map[_ngcontent-%COMP%]{width:80%;height:80%}"]}),r})();const m=function(r,n){return{"each-accepted":r,"each-expired":n}},_=function(r,n,t,i,c,s){return{"catagory-marker-yellow":r,"catagory-marker-blue":n,"catagory-marker-red":t,"catagory-marker-green":i,"catagory-marker-purple":c,"catagory-marker-grey":s}};function x(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"div",15),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit;return e.oxw(2).handleClick(c)}),e.TgZ(2,"h3",16),e._uU(3),e.qZA(),e._uU(4," by "),e.TgZ(5,"p",17),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e._UZ(10,"div",14),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("ngClass",e.WLB(9,m,t.fulfilled,t.expired)),e.xp6(3),e.Oqu(t.service.title),e.xp6(3),e.AsE("",t.firstname," ",t.lastname,""),e.xp6(2),e.Oqu(e.xi3(9,6,t.createdAt,"medium")),e.xp6(2),e.Q6J("ngClass",e.HTZ(12,_,"food"===t.service.catagory,"hygine"===t.service.catagory,"pets"===t.service.catagory,"entertainment"===t.service.catagory,"religion"===t.service.catagory,"education"===t.service.catagory))}}function T(r,n){if(1&r&&(e.TgZ(0,"div",12),e.YNc(1,x,11,19,"div",13),e.qZA()),2&r){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",!t.expired)}}function k(r,n){if(1&r&&(e.TgZ(0,"div",10),e.YNc(1,T,2,1,"div",11),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.services)}}function A(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"div",15),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit;return e.oxw(2).handleClick(c)}),e.TgZ(2,"h3",16),e._uU(3),e.qZA(),e._uU(4," by "),e.TgZ(5,"p",17),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e._UZ(10,"div",14),e.qZA()}if(2&r){const t=e.oxw().$implicit;e.Q6J("ngClass",e.WLB(9,m,t.fulfilled,t.expired)),e.xp6(3),e.Oqu(t.service.title),e.xp6(3),e.AsE("",t.firstname," ",t.lastname,""),e.xp6(2),e.Oqu(e.xi3(9,6,t.createdAt,"medium")),e.xp6(2),e.Q6J("ngClass",e.HTZ(12,_,"food"===t.service.catagory,"hygine"===t.service.catagory,"pets"===t.service.catagory,"entertainment"===t.service.catagory,"religion"===t.service.catagory,"education"===t.service.catagory))}}function S(r,n){if(1&r&&(e.TgZ(0,"div",12),e.YNc(1,A,11,19,"div",13),e.qZA()),2&r){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",!t.expired)}}function w(r,n){if(1&r&&(e.TgZ(0,"div",10),e.YNc(1,S,2,1,"div",11),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.searchResult)}}let R=(()=>{class r{constructor(t,i){this.recieve=t,this.router=i}handleClick(t){console.log(t),this.router.navigate(["","recieve","service",t._id])}addService(){this.router.navigate(["","add-service","request"],{state:{msg:"Add a Service"}})}searching(t){this.isSearching=!0,this.searchResult=this.services.filter(i=>i.service.title.toLowerCase().includes(t.target.value.toLowerCase())),t.target.value||(this.isSearching=!1)}previousGroup(){this.page>1&&this.recieve.getAllRequestServices(this.page-1).subscribe(t=>{this.services=t.data,this.services.forEach(i=>{this.checkDate(i)}),this.page--})}nextGroup(){this.page>=1&&this.recieve.getAllRequestServices(this.page+1).subscribe(t=>{t.data&&(this.services=t.data,this.services.forEach(i=>{this.checkDate(i)})),this.page++})}showMap(t){let i=t.location.coords,c=L.map("map").setView([i.latitude,i.longitude],13);L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWludGVzNCIsImEiOiJja3g2Y2htdDcya3ZqMnZwMnZ6ZnJtcXZjIn0.rI21ie3tyJCsjxxxoNLO1g",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"your.mapbox.access.token"}).addTo(c),L.marker([i.latitude,i.longitude]).addTo(c).bindPopup(`<b>${t.service.title}</b><br>by <b>${t.firstname}</b>`).openPopup(),L.popup().setLatLng([i.latitude,i.longitude]).setContent(`${t.service.title} by <b>${t.firstname}</b>`).openOn(c)}checkDate(t){console.log(t);let i=new Date,c=new Date(t.createdAt),s=Math.abs(i-c)/1e3;Math.floor(s/86400)>2?(console.log(t.service.title,t._id),t.expired=!0):t.expired=!1}ngOnInit(){this.recieve.getAllRequestServices().subscribe(t=>{this.services=t.data,this.page=1,this.services.forEach(i=>{console.log(i),this.checkDate(i),this.showMap(i)})})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(d.X),e.Y36(l.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-requested-services"]],decls:16,vars:2,consts:[[1,"i"],[1,"i-left"],[1,"circle-button","btn","btn-primary",3,"click"],[1,"prevBtn","btn","btn-basic","btn-lg",3,"click"],["class","i-middle",4,"ngIf","ngIfElse"],["search",""],[1,"i-right"],["placeholder","search service",1,"input","form-control","form-control-sm",3,"keyup"],[1,"nextBtn","btn","btn-basic","btn-lg",3,"click"],["id","map"],[1,"i-middle"],["class","each",4,"ngFor","ngForOf"],[1,"each"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[3,"click"],[1,"title"],[1,"sub-title"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return i.addService()}),e._uU(3," +"),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"button",3),e.NdJ("click",function(){return i.previousGroup()}),e._uU(6," << Previous "),e.qZA(),e.qZA(),e.YNc(7,k,2,1,"div",4),e.YNc(8,w,2,1,"ng-template",null,5,e.W1O),e.TgZ(10,"div",6),e.TgZ(11,"input",7),e.NdJ("keyup",function(s){return i.searching(s)}),e.qZA(),e.TgZ(12,"button",8),e.NdJ("click",function(){return i.nextGroup()}),e._uU(13," Next >> "),e.qZA(),e._UZ(14,"div",9),e.qZA(),e.qZA(),e._UZ(15,"router-outlet")),2&t){const c=e.MAs(9);e.xp6(7),e.Q6J("ngIf",!i.isSearching)("ngIfElse",c)}},directives:[o.O5,l.lC,o.sg,o.mk],pipes:[o.uU],styles:["#map[_ngcontent-%COMP%]{width:100%;height:70%}"]}),r})(),U=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[o.ez,l.Bz.forChild([{path:"",component:R},{path:"service/:id",component:q}])]]}),r})()}}]);